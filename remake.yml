packages:
  - callr
  - ggplot2
  - jsonlite

sources:
  - R

targets:
  all:
    depends:
      - ms.pdf

  ms.pdf:
    command: latex_build_clean("ms.tex", "refs.bib")
    depends:
      - figures

  figures:
    depends:
      - figures/energy_pc_plot_exp_f15.pdf
      - figures/energy_total_plot_exp_f15.pdf
      - figures/energy_pc_plot_exp_f10.pdf
      - figures/energy_total_plot_exp_f10.pdf
      - figures/exp_f10_k_history.pdf
      - figures/exp_f10_e_0_history.pdf
      - figures/exp_f10_k_density.pdf
      - figures/exp_f10_e_0_density.pdf
      - figures/exp_f15_k_history.pdf
      - figures/exp_f15_e_0_history.pdf
      - figures/exp_f15_k_density.pdf
      - figures/exp_f15_e_0_density.pdf
      - figures/exp_f10_num_winners.pdf
      - figures/exp_f15_num_winners.pdf

  figures/energy_pc_plot_exp_f15.pdf: 
    command: energy_pc_plot(exp_f15_last_gen)
    plot: true

  figures/energy_total_plot_exp_f15.pdf: 
    command: energy_total_plot(exp_f15_last_gen)
    plot: true

  figures/energy_pc_plot_exp_f10.pdf: 
    command: energy_pc_plot(exp_f10_last_gen)
    plot: true

  figures/energy_total_plot_exp_f10.pdf: 
    command: energy_total_plot(exp_f10_last_gen)
    plot: true

  figures/exp_f10_e_0_history.pdf:
    command: e_0_history_plot(exp_f10_last_gen)
    plot: true

  figures/exp_f10_k_history.pdf:
    command: k_history_plot(exp_f10_last_gen)
    plot: true

  figures/exp_f10_k_density.pdf: 
    command: k_density_plot(exp_f10_population)
    plot: true

  figures/exp_f10_e_0_density.pdf:
    command: e_0_density_plot(exp_f10_population)
    plot: true

  figures/exp_f15_e_0_history.pdf:
    command: e_0_history_plot(exp_f15_last_gen)
    plot: true

  figures/exp_f15_k_history.pdf:
    command: k_history_plot(exp_f15_last_gen)
    plot: true

  figures/exp_f15_k_density.pdf: 
    command: k_density_plot(exp_f15_population)
    plot: true

  figures/exp_f15_e_0_density.pdf:
    command: e_0_density_plot(exp_f15_population)
    plot: true

  figures/exp_f10_num_winners.pdf: 
    command: winners_plot(exp_f10_population)
    plot: true

  figures/exp_f15_num_winners.pdf: 
    command: winners_plot(exp_f15_population)
    plot: true

  exp_f15_population:
    command: load_population(I("python/data/exp_f15"), 3)

  exp_f15_trait_history:
    command: load_trait_history(I("python/data/exp_f15"), 3)
    
  exp_f15_last_gen: 
    command: get_generation ( exp_f15_trait_history, 499)


  exp_f10_population: 
    command: load_population(I("python/data/exp_f10"), 3)

  exp_f10_trait_history: 
    command: load_trait_history(I("python/data/exp_f10"), 3)
  
  exp_f10_last_gen: 
    command: get_generation ( exp_f10_trait_history, 499)
