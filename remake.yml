packages:
  - callr
  - ggplot2
  - jsonlite
  - plyr

sources:
  - R

targets:
  all:
    depends:
      - ms.pdf

  ms.pdf:
    command: latex_build_clean("ms.tex", "refs.bib")
    depends:
      - figures

  figures:
    depends:
      - figures/energy_pc_plot_cm_100.pdf
      - figures/energy_total_plot_cm_100.pdf
      - figures/e_0_patch_area.pdf
      - figures/k_patch_area.pdf
      - figures/e_0_nest_density.pdf
      - figures/k_nest_density.pdf
      - figures/cm_100_num_winners.pdf

  figures/energy_total_plot_cm_100.pdf: 
    command: energy_total_plot(cm_100_last_gen)
    plot: true

  figures/energy_pc_plot_cm_100.pdf: 
    command: energy_pc_plot(cm_100_last_gen)
    plot: true

  figures/e_0_patch_area.pdf:
    command: pop_values(cm_100_population, I("e_0"), I("patch_area"), I("k nest / patch_area <-"))
    plot: true

  figures/k_patch_area.pdf:
    command: pop_values(cm_100_population, I("k"), I("patch_area"), I("k nest / patch_area <-"))
    plot: true

  figures/e_0_nest_density.pdf:
    command: pop_values(cm_100_population, I("e_0"), I("log(N / patch_area)"), I("e_0 nest / patch_area ->"))
    plot: true

  figures/k_nest_density.pdf:
    command: pop_values(cm_100_population, I("k"), I("log(N / patch_area)"), I("K nest / patch_area ->"))
    plot: true

  figures/cm_100_num_winners.pdf: 
    command: winners_plot(cm_100_population)
    plot: true

  cm_100_population: 
    command: load_population(I("data/cm_100"))

  cm_100_trait_history: 
    command: load_trait_history(I("data/cm_100"))
  
  cm_100_last_gen: 
    command: get_generation ( cm_100_trait_history, 499)
