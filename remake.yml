packages:
  - callr
  - ggplot2
  - jsonlite

sources:
  - R

targets:
  all:
    depends:
      - ms.pdf

  ms.pdf:
    command: latex_build_clean("ms.tex", "refs.bib")
    depends:
      - figures

  figures:
    depends:
      - figures/contest_algorithm.pdf
      - figures/event_algorithm.pdf
      - figures/area_searched.pdf
      - figures/energy_pc_plot.pdf
      - figures/energy_total_plot.pdf
      - figures/num_winners.pdf
      - figures/k_density.pdf
      - figures/e_0_density.pdf
      - figures/k_history.pdf
      - figures/e_0_history.pdf
      - figures/aggression_density.pdf
      - figures/energy_pc_plot_var.pdf 
      - figures/energy_total_plot_var.pdf

  figures/energy_pc_plot.pdf: 
    command: energy_pc_plot(last_gen_flat)
    plot: true

  figures/energy_total_plot.pdf: 
    command: energy_total_plot(last_gen_flat)
    plot: true

  figures/e_0_history.pdf:
    command: e_0_history_plot(last_gen_flat)
    plot: true

  figures/k_history.pdf:
    command: k_history_plot(last_gen_flat)
    plot: true

  figures/num_winners.pdf: 
    command: winners_plot(flat_cost_population)
    plot: true

  figures/aggression_density.pdf: 
    command: aggression_density_plots(flat_cost_population)
    plot: true

  figures/k_density.pdf: 
    command: k_density_plot(flat_cost_population)
    plot: true

  figures/e_0_density.pdf:
    command: e_0_density_plot(flat_cost_population)
    plot: true

  figures/energy_pc_plot_var.pdf: 
    command: energy_pc_plot(last_gen_variable)
    plot: true

  figures/energy_total_plot_var.pdf: 
    command: energy_total_plot(last_gen_variable)
    plot: true

  flat_cost_trait_history: 
    command: load_trait_history(I("python/data/flat_50"), 3)

  flat_cost_population: 
    command: load_population(I("python/data/flat_50"), 3)

  variables_cost_trait_history:
    command: load_trait_history(I("python/data/variable_costs"), 3)
    
  last_gen_flat: 
    command: get_generation ( flat_cost_trait_history, 499)

  last_gen_variable: 
    command: get_generation ( variables_cost_trait_history, 499)

