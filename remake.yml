packages:
  - callr
  - ggplot2
  - jsonlite
  - plyr
  - fpc

sources:
  - R

targets:
  all:
    depends:
      - ms.pdf

  ms.pdf:
    command: latex_build_clean("ms.tex", "refs.bib")
    depends:
      - figures

  figures:
    depends:
      - figures/energy_pc_plot_cm_100.png
      - figures/energy_total_plot_cm_100.png
      - figures/e_0_patch_area.png
      - figures/clustered_e_0_plot.pdf

  figures/energy_total_plot_cm_100.png: 
    command: energy_total_plot(cm_100_last_gen)
    plot: true

  figures/clustered_e_0_plot.pdf: 
    command: clustered_e_0_plot(cm_100_population)
    plot: true

  figures/e_0_patch_area.png:
    command: pop_values(cm_100_population, I("patch_area"), I("e_0"), I("beta"))
    plot: true
    
  figures/k_patch_area.png:
    command: pop_values(cm_100_population, I("patch_area"),I("k"),  I("k nest / patch_area <-"))
    plot: true

  cm_100_population: 
    command: load_population(I("data/cm_100"))

  cm_100_trait_history: 
    command: load_trait_history(I("data/cm_100"))
  
  cm_100_last_gen: 
    command: get_generation ( cm_100_trait_history, 499)
