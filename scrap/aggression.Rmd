---
title: "Aggression Exploration"
author: "John"
date: "1 February 2016"
output: html_document
---

This is for exploring aggression levels with the two inheritable traits "E_0" and "K"
Currently E_curr is the actual current energy of the male, I think that it would be better if it were a % of max?

$$ a_i = f( E_{current} ) = \frac {L}{1 + exp(-K(E_{current} - E_0))}  $$

```{R}
library(rasterVis)

k_min <- -5
k_max <- 5
e_0_min <- -5
e_0_max <- 5

L <- 2

get_level_plotable <- function (e_current){
  old_aggression <- function(L, k, e_0){
    L / (1 + exp(k*e_current + e_0))
  }
  k_val <- seq(k_min, k_max, by = 0.01)
  e_0_val <- seq(e_0_min, e_0_max, by = 0.01)
  r <- raster(outer(k_val, e_0_val, function(a, b){ old_aggression(L, a, b)}), 
              xmn = k_min,
              xmx = k_max,
              ymn = e_0_min,
              ymx = e_0_max)
  return(r)
}
my_theme <- BuRdTheme()

my_at <- seq(0, L, length.out=length(my_theme$regions$col) - 1)
my_ckey <- list(at=my_at, col=my_theme$regions$col)

```

Lets see what this looks like for an individual with max energy (e_current = 1)

```{R}

levelplot(get_level_plotable(1), margin=FALSE, xlab = "K", ylab = "E_0", main = "Aggression, energy = 100%", at = my_at, colorkey = my_ckey, par.settings=my_theme)

```

half energy (e_current = 0.5)

```{R}
levelplot(get_level_plotable(0.5), margin=FALSE, xlab = "K", ylab = "E_0", main = "Aggression, energy = 50%", at = my_at, colorkey = my_ckey, par.settings=my_theme)
```

close to 0 energy (e_current = 0.1)
```{R}

levelplot(get_level_plotable(0.1), margin=FALSE, xlab = "K", ylab = "E_0", main = "Aggression, energy = 10%", at = my_at, colorkey = my_ckey, par.settings=my_theme)

```